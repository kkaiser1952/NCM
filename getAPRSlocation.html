<!DOCTYPE html>
<html>
  <head>
    <title>APRS API Test</title>
    
    <link rel="shortcut icon" href="#" />

    <meta charset = "UTF-8" />
  </head>
  <body>
    <h1>APRS API Test</h1>
    <label for="callsign">Callsign:</label>
    <input type="text" id="callsign" name="callsign" />
    <button onclick="getAPRSData()">Get Location</button>
    <div id="location"></div>
    <script>
      function getAPRSData() {
        var callsign = document.getElementById("callsign").value.toUpperCase();
        var apiKey = "5275.AYRjLwAFgx6ud"; // replace with your API key
        /*var url = `https://api.aprs.fi/api/get?name=${callsign}&what=loc&apikey=${apiKey}apiKey&format=json`; */
        var url = `https://crossorigin.me/https://api.aprs.fi/api/get?name=${callsign}&what=loc&apikey=${apiKey}apiKey&format=json`;
        fetch(url)
          .then(response => response.json())
          .then(data => {
            if (data.result === "ok") {
             // var location = data.entries[0].lat + ", " + data.entries[0].lng;
             var location = JSON.stringify(data.entries[0], null, 2);
              
              document.getElementById("location").innerHTML = location;
            } else {
              throw new Error(data.description);
            }
          })
         // .catch(error => console.error(error));
      }
    </script>
  </body>
</html>